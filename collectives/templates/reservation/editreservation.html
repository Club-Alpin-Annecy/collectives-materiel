{% extends 'base.html' %}

{% block additionalhead %}
  {# Tabulator: for tables#}
  <script type="text/javascript" src="https://unpkg.com/tabulator-tables@4.9.3/dist/js/tabulator.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment-with-locales.min.js"></script>

  {# DateTime picker#}
  <script src="{{ url_for('static', filename='js/tail.datetime-full.min.js') }}"></script>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/tail.datetime-harx-light.min.css')}}">
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment-with-locales.min.js"></script>
{% endblock %}

{% block header %}
  <h1>{% block title %}Réservation{% endblock %}</h1>
{% endblock %}

{% block content %}
<div class="panel">
  <!-- Logging Windows -->
  <h3>Réservation en tant qu'encadrant</h3>
  <div class="form-errors">
    {% for field in form%}
      {% for error in form.errors[field.name] %}
        <div class="flash flash-error">
          <strong>Erreur : {{field.label}} :</strong> {{error}}
        </div>
      {% endfor %}
    {% endfor %}
  </div>

  <div class="dates">
    <div class="controls">
      <div class="datetimepicker" id="datetimepickerstart">
        {{ form.collect_date.label }} : {{ form.collect_date(type="datetime") }}
      </div>
    </div>
  </div>

  <h4>Ajouter un équipement</h4>
  <div id="equipment-type-table"></div>
  <script>
    const token_csrf = "{{ csrf_token() }}";
    const icon_add_column = "{{ url_for('static', filename='img/icon/ionicon/md-add-circle-outline.svg') }}";
    var ajaxURL = "{{url_for('api.equipmentTypes')}}";
  </script>
  <script src="{{ url_for('static', filename='js/equipment/tabulator_equipment_types_add.js') }}"></script>

  <h4>Votre panier</h4>
  <div id="equipment-type-taken-table"></div>
  <script src="{{ url_for('static', filename='js/equipment/tabulator_equipment_types_taken.js') }}"></script>

  <div class="controls">
    {{ form.submit(class="button button-primary") }}
  </div>

</div>
<script>
  document.querySelectorAll("input[type=datetime]").forEach(function(input){
    var datepicker = tail.DateTime(input,{
        animate: false,
        weekStart: 1,
        locale: "fr",
        timeStepMinutes: 15,
        timeSeconds: false,
        closeButton: false,
        startOpen: true,
        stayOpen: true,
        position: "#"+input.parentElement.id,
        classNames:"form-tail-datetime default",
    });
  });
</script>
{% endblock %}